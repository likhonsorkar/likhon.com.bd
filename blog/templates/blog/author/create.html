{% extends "blog/author/author.html" %}
{% block contents %}
        <main class="flex-1 p-10">
            <header class="mb-10" data-aos="fade-down">
                <h2 class="text-4xl font-bold text-purple-corallite">{% if form.instance.pk %}Edit{% else %}Create New{% endif %} Article</h2>
                <p class="text-lg mt-2">Fill out the form below to publish a new post.</p>
            </header>

            <div class="bg-white p-8 rounded-lg shadow-lg" data-aos="fade-up">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-6">
                        <label for="{{ form.title.id_for_label }}" class="block text-lg font-medium text-gray-800 mb-2">Article Title</label>
                        {{ form.title }}
                    </div>
                    <div class="mb-6">
                        <label for="{{ form.content.id_for_label }}" class="block text-lg font-medium text-gray-800 mb-2">Article Content</label>
                        {{ form.content }}
                    </div>
                    <div class="mb-6">
                        <label for="{{ form.featured_image.id_for_label }}" class="block text-lg font-medium text-gray-800 mb-2">Featured Image</label>
                        {{ form.featured_image }}
                    </div>
                    <div class="mb-6">
                        <label for="{{ form.tags.id_for_label }}" class="block text-lg font-medium text-gray-800 mb-2">Tags</label>
                        {{ form.tags }}
                    </div>
                    <div class="mt-8 text-right">
                        <button type="submit" class="bg-purple-corallite hover:bg-purple-mountain-majesty text-white font-bold py-3 px-8 rounded-full transition duration-300">Publish Article</button>
                    </div>
                </form>
            </div>
        </main>
    
    <!-- TinyMCE -->
    <script src="https://cdn.tiny.cloud/1/p2bqko9b1r9cn38lwov210l840ejrmyo6udztqt2g0et0g4p/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    
    <!-- AOS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize TinyMCE
            tinymce.init({
                selector: '#id_content',
                plugins: 'image code link lists',
                toolbar: 'undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | link image | code | numlist bullist',
                automatic_uploads: true,
                images_upload_url: '{% url "image_upload" %}',
                file_picker_types: 'image',
                file_picker_callback: function (cb, value, meta) {
                    var input = document.createElement('input');
                    input.setAttribute('type', 'file');
                    input.setAttribute('accept', 'image/*');

                    input.onchange = function () {
                        var file = this.files[0];
                        var reader = new FileReader();
                        reader.onload = function () {
                            var id = 'blobid' + (new Date()).getTime();
                            var blobCache = tinymce.activeEditor.editorUpload.blobCache;
                            var base64 = reader.result.split(',')[1];
                            var blobInfo = blobCache.create(id, file, base64);
                            blobCache.add(blobInfo);
                            cb(blobInfo.blobUri(), { title: file.name });
                        };
                        reader.readAsDataURL(file);
                    };
                    input.click();
                }
            });

            // Initialize Select2
            $('#id_tags').select2({
                width: '100%'
            });

            // Initialize AOS
            AOS.init({ 
                duration: 800, 
                once: true 
            });
        });
    </script>
{% endblock contents %}